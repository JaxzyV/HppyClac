<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kalkulator HPP - Harga Pokok Penjualan</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Pastikan ini di atas script.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  </head>
  <body>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPPyClac Navigasi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Tailwind Configuration for HppyClac Theme */
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'hppy-blue': '#87CEEB', /* Sky Blue */
                        'hppy-white': '#FFFFFF', /* Snow White */
                        'hppy-dark': '#2c3e50', /* Darker accent for text/links */
                    },
                }
            }
        }
        /* Ensure no horizontal scrollbar */
        body {
            overflow-x: hidden;
        }
    </style>
</head>

<body>
    <nav class="bg-blue-500 shadow-xl sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center gap-2 flex-shrink-0">
                    <img
                        src="logoCashup.png"
                        class="w-13 h-13 rounded-full border-2 border-hppy-blue"
                        alt="HppyClac Logo"
                    />
                    <h1 class="text-white text-3xl font-extrabold hover:text-hppy-blue transition duration-300">
                        HPPyCalc
                    </h1>
                </div>

                <ul class="hidden md:flex space-x-8 text-hppy-dark font-semibold nav-links text-lg">
                    <li>
                        <a href="#kalkulator" onclick="showSection('kalkulator')"
                            class="hover:text-hppy-blue transition duration-300 py-2 border-b-2 border-transparent hover:border-hppy-blue"
                        >
                            Kalkulator HPP
                        </a>
                    </li>
                    <li>
                        <a href="#riwayat" onclick="showSection('riwayat')"
                            class="hover:text-hppy-blue transition duration-300 py-2 border-b-2 border-transparent hover:border-hppy-blue"
                        >
                            Riwayat
                        </a>
                    </li>
                    <li>
                        <a href="#tentang" onclick="showSection('tentang')"
                            class="hover:text-hppy-blue transition duration-300 py-2 border-b-2 border-transparent hover:border-hppy-blue"
                        >
                            Tentang
                        </a>
                    </li>
                </ul>

                <div class="md:hidden">
                    <button
                        id="mobile-menu-button"
                        class="text-hppy-dark p-2 rounded-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-hppy-blue transition duration-300"
                        aria-label="Toggle Menu"
                    >
                        <svg
                            class="h-6 w-6"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16"
                            />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div id="mobile-menu" class="hidden md:hidden border-t border-gray-200">
            <ul class="px-2 pt-2 pb-3 space-y-1 sm:px-3 text-hppy-dark bg-gray-50">
                <li>
                    <a
                        href="#kalkulator"
                        onclick="showSectionAndHideMenu('kalkulator')"
                        class="block px-3 py-2 rounded-md text-base font-medium hover:bg-hppy-blue hover:text-white transition duration-300"
                    >
                        Kalkulator HPP
                    </a>
                </li>
                <li>
                    <a
                        href="#riwayat"
                        onclick="showSectionAndHideMenu('riwayat')"
                        class="block px-3 py-2 rounded-md text-base font-medium hover:bg-hppy-blue hover:text-white transition duration-300"
                    >
                        Riwayat
                    </a>
                </li>
                <li>
                    <a
                        href="#tentang"
                        onclick="showSectionAndHideMenu('tentang')"
                        class="block px-3 py-2 rounded-md text-base font-medium hover:bg-hppy-blue hover:text-white transition duration-300"
                    >
                        Tentang
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <main class="container">
      <section id="kalkulator" class="active-section">
        <h2>Kalkulator Harga Pokok Penjualan (HPP)</h2>

        <div class="card instruksi-card">
          <h3 onclick="toggleInstruksi(this)">
            Cara Menggunakan üí° (Klik untuk Buka/Tutup)
          </h3>
          <div class="instruksi-content">
            <ol>
              <li>Isi Nama Produk untuk identifikasi.</li>
              <li>
                Masukkan biaya Bahan Baku dan Biaya Lain-Lain (klik tombol +
                untuk menambah baris).
              </li>
              <li>Isi Total Biaya Tenaga Kerja dan Jumlah Unit Produksi.</li>
              <li>Klik 'Hitung HPP' untuk melihat hasilnya.</li>
              <li>Isi Margin Laba (persen) dan klik 'Hitung Harga Jual'.</li>
              <li>Gunakan tombol 'Simpan ke Riwayat' dan 'Export PDF'.</li>
            </ol>
          </div>
        </div>

        <form id="hpp-form" class="card form-card">
          <h3>Detail Produk & Unit</h3>
          <label for="productName">Nama Produk:</label>
          <input
            type="text"
            id="productName"
            placeholder="Contoh: Kue Cokelat (500g)"
            required
          />

          <label for="jumlahUnit">Jumlah Unit Produksi:</label>
          <input
            type="number"
            id="jumlahUnit"
            min="1"
            placeholder="Cth: 100"
            required
          />

          <h3>1. Biaya Bahan Baku (BB)</h3>
          <div id="bahanBakuContainer" class="dynamic-input-container"></div>
          <button
            type="button"
            class="btn-tambah"
            onclick="addItemRow('bahanBaku', 'BB', 1)"
          >
            + Tambah Bahan Baku
          </button>
          <p class="total-summary">
            Total Biaya Bahan Baku: <span id="totalBahanBakuDisplay">Rp 0</span>
          </p>

          <h3>2. Biaya Tenaga Kerja Langsung (BTKL)</h3>
          <label for="biayaTenagaKerja">Total Biaya Tenaga Kerja:</label>
          <input
            type="number"
            id="biayaTenagaKerja"
            min="0"
            placeholder="Rp Total Gaji & Upah"
            required
          />
          <p class="total-summary">
            Total Biaya Tenaga Kerja:
            <span id="totalTenagaKerjaDisplay">Rp 0</span>
          </p>

          <h3>3. Biaya Overhead Pabrik (BOP) / Lain-lain</h3>
          <div
            id="biayaLainLainContainer"
            class="dynamic-input-container"
          ></div>
          <button
            type="button"
            class="btn-tambah"
            onclick="addItemRow('biayaLainLain', 'BOP', 1)"
          >
            + Tambah Biaya Lain-lain
          </button>
          <p class="total-summary">
            Total Biaya Lain-Lain: <span id="totalLainLainDisplay">Rp 0</span>
          </p>

          <div class="form-actions">
            <button type="submit" class="btn-hitung px-3 py-1">Hitung HPP</button>
            <button type="button" class="btn-reset px-2 py-1" onclick="resetForm()">
              Reset Form
            </button>
          </div>
        </form>

        <div
          id="hasil-perhitungan"
          class="card result-card hidden"
          style="margin-top: 20px"
        >
          <h3>Hasil Perhitungan HPP</h3>
          <div id="ringkasan-angka" class="summary-grid">
            <div class="summary-item">
              Total Biaya Produksi:
              <span id="outputTotalBiaya" class="counter">0</span>
            </div>
            <div class="summary-item main-result">
              HPP per Unit: <span id="outputHPPUnit" class="counter">0</span>
            </div>
          </div>

          <div class="harga-jual-section">
            <h4>Hitung Harga Jual Saran</h4>
            <label for="marginLaba">Margin Laba yang Diinginkan (%) :</label>
            <input
              type="number"
              id="marginLaba"
              min="0"
              max="100"
              placeholder="Cth: 20"
              value="20"
            />
            <button
              type="button"
              class="btn-margin"
              onclick="hitungHargaJual()"
            >
              Hitung Harga Jual
            </button>
            <div class="harga-jual-output hidden">
              Harga Jual Saran per Unit (Margin
              <span id="marginPersenOutput">0</span>%):
              <span id="outputHargaJual" class="counter">0</span>
            </div>
          </div>

          <hr />

          <h4>Ringkasan Komposisi Biaya Produksi</h4>
          <div class="table-container">
            <table id="tabel-ringkasan-biaya">
              <thead>
                <tr>
                  <th>Komponen Biaya</th>
                  <th>Total Biaya</th>
                  <th>Persentase</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Bahan Baku (BB)</td>
                  <td id="ringkasanBB">Rp 0</td>
                  <td id="persenBB">0%</td>
                </tr>
                <tr>
                  <td>Tenaga Kerja (BTKL)</td>
                  <td id="ringkasanBTKL">Rp 0</td>
                  <td id="persenBTKL">0%</td>
                </tr>
                <tr>
                  <td>Overhead (BOP)</td>
                  <td id="ringkasanBOP">Rp 0</td>
                  <td id="persenBOP">0%</td>
                </tr>
                <tr class="total-row">
                  <td>TOTAL</td>
                  <td id="ringkasanTOTAL">Rp 0</td>
                  <td>100%</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h4>Grafik Komposisi Biaya</h4>
          <div class="chart-container">
            <canvas id="biayaChart"></canvas>
          </div>

          <div class="result-actions">
            <button
              type="button"
              class="btn-export"
              onclick="simpanKeRiwayat()"
            >
              üíæ Simpan ke Riwayat
            </button>
            <button type="button" class="btn-export" onclick="exportToPDF()">
              üìÑ Export ke PDF
            </button>
          </div>
        </div>
      </section>

      <section id="riwayat" class="hidden-section">
        <h2>Riwayat Perhitungan HPP</h2>
        <div id="riwayat-list" class="riwayat-list-container">
          <p id="riwayat-kosong">
            Belum ada riwayat tersimpan. Silakan hitung HPP terlebih dahulu.
          </p>
        </div>
      </section>

      <section id="tentang" class="hidden-section">
        <h2>Tentang Aplikasi Kalkulator HPP</h2>
        <div class="card">
          <p>
            Aplikasi ini dirancang untuk membantu UMKM atau individu menghitung
            Harga Pokok Penjualan (HPP) per unit produk berdasarkan standar
            akuntansi biaya produksi (Biaya Bahan Baku + Biaya Tenaga Kerja +
            Biaya Overhead).
          </p>
          <p><strong>Fitur Utama:</strong></p>
          <ul>
            <li>Perhitungan HPP akurat.</li>
            <li>Input biaya dinamis (bahan baku & biaya lain-lain).</li>
            <li>Perhitungan harga jual saran berdasarkan margin laba.</li>
            <li>Penyimpanan riwayat lokal menggunakan `localStorage`.</li>
            <li>Visualisasi komposisi biaya dengan grafik (Chart.js).</li>
            <li>Export hasil perhitungan ke format PDF (jsPDF).</li>
            <li>Desain responsif dan modern.</li>
          </ul>
          <p>Dibuat dengan ‚ù§Ô∏è menggunakan HTML, CSS, dan JavaScript.</p>
        </div>
      </section>
    </main>

    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script>
      const mobileMenuButton = document.getElementById("mobile-menu-button");
      const mobileMenu = document.getElementById("mobile-menu");

      // Function to toggle the mobile menu visibility
      mobileMenuButton.addEventListener("click", () => {
        mobileMenu.classList.toggle("hidden");
      });

      // Modified showSection function to handle menu closing on mobile
      function showSectionAndHideMenu(sectionId) {
        // Your existing logic to show the section (assuming showSection function is defined elsewhere)
        if (typeof showSection === "function") {
          showSection(sectionId);
        } else {
          console.warn("The showSection function is not defined.");
        }

        // Hide the mobile menu after clicking a link
        if (!mobileMenu.classList.contains("hidden")) {
          mobileMenu.classList.add("hidden");
        }
      }

      // You should ensure that your original showSection function is defined like this:
      /*
    function showSection(sectionId) {
        // Logic to hide all sections and show the selected one
        console.log('Showing section: ' + sectionId); 
        // Example: document.getElementById(sectionId).style.display = 'block';
    }
    */
    </script>
  </body>
</html>
